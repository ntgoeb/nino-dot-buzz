<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <title>Super Star Trek - Nino's Webhome</title>
    <link rel="stylesheet" href="style/default-style.css">
    <style>
        .under-construction {
            text-align: center;
            padding: 15px;
            border: 3px dashed #ffff00;
            background: repeating-linear-gradient(
                45deg,
                #000000,
                #000000 10px,
                #ffcc00 10px,
                #ffcc00 20px
            );
            margin: 20px 0;
            font-size: 18px;
            font-weight: bold;
        }

        .under-construction-inner {
            background: #000000;
            padding: 10px 20px;
            display: inline-block;
            border: 2px solid #ffff00;
        }

        .under-construction-inner span {
            color: #ffff00;
            animation: blink 1s ease-in-out infinite;
        }

        .game-window {
            font-family: monospace;
            background-color: #000033;
            color: #00ff00;
            padding: 20px;
            border: 3px ridge #00ff00;
            height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-bottom: 20px;
        }

        .command-input {
            width: 100%;
            background: #000000;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 10px;
            font-family: monospace;
            margin-top: 10px;
            box-sizing: border-box;
        }

        .game-instructions {
            border: 2px dashed #ff00ff;
            padding: 15px;
            margin: 20px 0;
            background-color: #000033;
        }

        .game-instructions h2 {
            margin-top: 0;
        }

        .game-instructions p {
            margin: 5px 0;
            color: #00ffff;
        }

        #output {
            font-size: 14px;
            line-height: 1.4;
        }

        .command-history {
            color: #666666;
            font-style: italic;
        }

        .log-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .log-modal.active {
            display: flex;
        }

        .log-modal-content {
            background: #000033;
            border: 3px ridge #00ff00;
            padding: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
        }

        .log-modal-content h2 {
            color: #00ff00;
            font-family: monospace;
            margin: 0 0 10px 0;
            font-size: 16px;
        }

        .log-modal-content textarea {
            background: #000000;
            color: #00ff00;
            border: 2px solid #00ff00;
            font-family: monospace;
            font-size: 14px;
            padding: 10px;
            resize: vertical;
            min-height: 200px;
            flex: 1;
            box-sizing: border-box;
            width: 100%;
        }

        .log-modal-content textarea::placeholder {
            color: #006600;
        }

        .log-modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .log-modal-buttons button {
            flex: 1;
            padding: 8px 16px;
            font-family: monospace;
            font-size: 14px;
            cursor: pointer;
            border: 2px solid #00ff00;
            background: #000033;
            color: #00ff00;
        }

        .log-modal-buttons button:hover {
            background: #003300;
        }

        @media (max-width: 600px) {
            .game-window {
                height: 350px;
                font-size: 12px;
            }

            .log-modal-content {
                width: 95%;
                padding: 15px;
            }

            .log-modal-content textarea {
                min-height: 150px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <nav>
            <a href="index.html">Home</a>
            <a href="games.html">Games</a>
            <a href="links.html">Links</a>
            <div class="music-player">
                <button id="music-btn" onclick="toggleMusic()" title="Play random music">
                    <span id="music-icon">üéµ</span>
                </button>
                <span id="now-playing"></span>
                <audio id="audio-player"></audio>
            </div>
        </nav>

        <h1>Super Star Trek</h1>

        <div class="under-construction">
            <div class="under-construction-inner">
                <span>üöß UNDER CONSTRUCTION üöß</span>
            </div>
        </div>

        <div class="game-instructions">
            <h2>Quick Commands:</h2>
            <p>WARP x, y - Move between quadrants</p>
            <p>IMPULSE x, y - Move within quadrant</p>
            <p>SRSCAN / LRSCAN / STARMAP - Scans</p>
            <p>PHASERS n - Fire phasers (n energy)</p>
            <p>TORPEDOES x, y - Fire torpedo at sector</p>
            <p>COMPUTER - Replicator (crew buffs)</p>
            <p>SAVE - Save game / LOG - Captain's log</p>
            <p>SELFDESTRUCT - Self-destruct (last resort)</p>
            <p>Type 'HELP' for full instructions</p>
        </div>

        <div id="gameContainer">
            <div id="output" class="game-window"></div>
            <input type="text" id="command" class="command-input" placeholder="Enter command..." autocomplete="off">
        </div>

        <div id="logModal" class="log-modal">
            <div class="log-modal-content">
                <h2>Captain's Log</h2>
                <textarea id="logText" placeholder="Enter your notes here..."></textarea>
                <div class="log-modal-buttons">
                    <button id="logSave">Save Log</button>
                    <button id="logCancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Game engine -->
    <script src="sst.js"></script>

    <!-- Interface script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const output = document.getElementById('output');
            const commandInput = document.getElementById('command');
            const logModal = document.getElementById('logModal');
            const logText = document.getElementById('logText');
            const logSaveBtn = document.getElementById('logSave');
            const logCancelBtn = document.getElementById('logCancel');

            let logSaveCallback = null;

            // Initialize the game engine with output element
            SST.init(output);

            // Set up the log editor
            SST.setLogEditor(function(currentLog, onSave) {
                logText.value = currentLog;
                logModal.classList.add('active');
                logText.focus();
                logSaveCallback = onSave;
            });

            function closeLogModal() {
                logModal.classList.remove('active');
                logSaveCallback = null;
                commandInput.focus();
            }

            logSaveBtn.addEventListener('click', function() {
                if (logSaveCallback) {
                    logSaveCallback(logText.value);
                }
                closeLogModal();
            });

            logCancelBtn.addEventListener('click', function() {
                SST.print('');
                SST.print('Log edit cancelled.');
                SST.print('');
                closeLogModal();
            });

            // Close modal on Escape
            logModal.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    logCancelBtn.click();
                }
            });

            // Handle command input
            commandInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const command = commandInput.value;
                    SST.print('> ' + command);
                    SST.process(command);
                    commandInput.value = '';
                }
            });

            // Start game (checks for saved game)
            SST.start();
        });
    </script>
    <script>
        // Music Player
        const musicTracks = [
            '8bit_Dungeon_Level.mp3', 'Bit_Quest.mp3', 'Carefree.mp3', 'Chipper_Doodle.mp3',
            'Crypto.mp3', 'Digital_Lemonade.mp3', 'Disco_Medusae.mp3', 'Electrodoodle.mp3',
            'Fluffing_a_Duck.mp3', 'Funky_Chunk.mp3', 'Hard_Boiled.mp3', 'Hyperfun.mp3',
            'Investigations.mp3', 'Monkeys_Spinning_Monkeys.mp3', 'Neon_Laser_Horizon.mp3',
            'Pinball_Spring.mp3', 'Pixelland.mp3', 'Quirky_Dog.mp3', 'Run_Amok.mp3',
            'Sneaky_Snitch.mp3', 'Space_Fighter_Loop.mp3', 'Spy_Glass.mp3', 'Super_Friendly.mp3',
            'The_Builder.mp3', 'Wallpaper.mp3', 'Your_Call.mp3'
        ];
        const audioPlayer = document.getElementById('audio-player');
        const musicIcon = document.getElementById('music-icon');
        const nowPlaying = document.getElementById('now-playing');
        let isMusicPlaying = false;

        function playRandomTrack() {
            const track = musicTracks[Math.floor(Math.random() * musicTracks.length)];
            audioPlayer.src = 'music/' + track;
            audioPlayer.play();
            nowPlaying.textContent = track;
            isMusicPlaying = true;
            musicIcon.textContent = '‚è∏Ô∏è';
        }

        function toggleMusic() {
            if (isMusicPlaying) {
                audioPlayer.pause();
                isMusicPlaying = false;
                musicIcon.textContent = '‚ñ∂Ô∏è';
            } else {
                playRandomTrack();
            }
        }

        audioPlayer.addEventListener('ended', playRandomTrack);
    </script>
    <script type="module" src="js/analytics.js"></script>
</body>
</html>
